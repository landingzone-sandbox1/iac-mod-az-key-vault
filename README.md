<!-- BEGIN_TF_DOCS -->
## Requirements

No requirements.

## Providers

| Name | Version |
|------|---------|
| <a name="provider_azurerm"></a> [azurerm](#provider\_azurerm) | n/a |

## Modules

No modules.

## Resources

| Name | Type |
|------|------|
| [azurerm_key_vault.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/key_vault) | resource |
| [azurerm_management_lock.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/management_lock) | resource |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_application_code"></a> [application\_code](#input\_application\_code) | 4 letter abbreviation of the associated application | `string` | n/a | yes |
| <a name="input_certificate_permissions"></a> [certificate\_permissions](#input\_certificate\_permissions) | List of permissions for certificates in the Key Vault. | `list(string)` | <pre>[<br/>  "Get",<br/>  "List",<br/>  "Create",<br/>  "Delete"<br/>]</pre> | no |
| <a name="input_contacts"></a> [contacts](#input\_contacts) | A map of contacts for the Key Vault. The map key is deliberately arbitrary to avoid issues where map keys maybe unknown at plan time. | <pre>map(object({<br/>    email = string<br/>    name  = optional(string, null)<br/>    phone = optional(string, null)<br/>  }))</pre> | `{}` | no |
| <a name="input_correlative"></a> [correlative](#input\_correlative) | n/a | `string` | `"01"` | no |
| <a name="input_enabled_for_deployment"></a> [enabled\_for\_deployment](#input\_enabled\_for\_deployment) | Specifies whether Azure Virtual Machines are permitted to retrieve certificates stored as secrets from the vault. | `bool` | `false` | no |
| <a name="input_enabled_for_disk_encryption"></a> [enabled\_for\_disk\_encryption](#input\_enabled\_for\_disk\_encryption) | Specifies whether Azure Disk Encryption is permitted to retrieve secrets from the vault and unwrap keys. | `bool` | `true` | no |
| <a name="input_enabled_for_template_deployment"></a> [enabled\_for\_template\_deployment](#input\_enabled\_for\_template\_deployment) | Specifies whether Azure Resource Manager is permitted to retrieve secrets from the vault. | `bool` | `false` | no |
| <a name="input_environment"></a> [environment](#input\_environment) | Environment code (e.g., D, P, C, F) | `string` | n/a | yes |
| <a name="input_key_permissions"></a> [key\_permissions](#input\_key\_permissions) | List of permissions for keys in the Key Vault. | `list(string)` | <pre>[<br/>  "Get",<br/>  "Create",<br/>  "Delete"<br/>]</pre> | no |
| <a name="input_keys"></a> [keys](#input\_keys) | A map of keys to create on the Key Vault. The map key is deliberately arbitrary to avoid issues where map keys maybe unknown at plan time.<br/><br/>- `name` - The name of the key.<br/>- `key_type` - The type of the key. Possible values are `EC` and `RSA`.<br/>- `key_opts` - A list of key options. Possible values are `decrypt`, `encrypt`, `sign`, `unwrapKey`, `verify`, and `wrapKey`.<br/>- `key_size` - The size of the key. Required for `RSA` keys.<br/>- `curve` - The curve of the key. Required for `EC` keys.  Possible values are `P-256`, `P-256K`, `P-384`, and `P-521`. The API will default to `P-256` if nothing is specified.<br/>- `not_before_date` - The not before date of the key.<br/>- `expiration_date` - The expiration date of the key.<br/>- `tags` - A mapping of tags to assign to the key.<br/>- `rotation_policy` - The rotation policy of the key.<br/>  - `automatic` - The automatic rotation policy of the key.<br/>    - `time_after_creation` - The time after creation of the key before it is automatically rotated.<br/>    - `time_before_expiry` - The time before expiry of the key before it is automatically rotated.<br/>  - `expire_after` - The time after which the key expires.<br/>  - `notify_before_expiry` - The time before expiry of the key when notification emails will be sent.<br/><br/>Supply role assignments in the same way as for `var.role_assignments`. | <pre>map(object({<br/>    name     = string<br/>    key_type = string<br/>    key_opts = optional(list(string), ["sign", "verify"])<br/><br/>    key_size        = optional(number, null)<br/>    curve           = optional(string, null)<br/>    not_before_date = optional(string, null)<br/>    expiration_date = optional(string, null)<br/>    tags            = optional(map(any), null)<br/><br/>    role_assignments = optional(map(object({<br/>      role_definition_id_or_name             = string<br/>      principal_id                           = string<br/>      description                            = optional(string, null)<br/>      skip_service_principal_aad_check       = optional(bool, false)<br/>      condition                              = optional(string, null)<br/>      condition_version                      = optional(string, null)<br/>      delegated_managed_identity_resource_id = optional(string, null)<br/>      principal_type                         = optional(string, null)<br/>    })), {})<br/><br/>    rotation_policy = optional(object({<br/>      automatic = optional(object({<br/>        time_after_creation = optional(string, null)<br/>        time_before_expiry  = optional(string, null)<br/>      }), null)<br/>      expire_after         = optional(string, null)<br/>      notify_before_expiry = optional(string, null)<br/>    }), null)<br/>  }))</pre> | `{}` | no |
| <a name="input_legacy_access_policies"></a> [legacy\_access\_policies](#input\_legacy\_access\_policies) | A map of legacy access policies to create on the Key Vault. The map key is deliberately arbitrary to avoid issues where map keys maybe unknown at plan time.<br/><br/>Requires `var.legacy_access_policies_enabled` to be `true`.<br/><br/>- `object_id` - (Required) The object ID of the principal to assign the access policy to.<br/>- `application_id` - (Optional) The object ID of an Application in Azure Active Directory. Changing this forces a new resource to be created.<br/>- `certifiate_permissions` - (Optional) A list of certificate permissions. Possible values are: `Backup`, `Create`, `Delete`, `DeleteIssuers`, `Get`, `GetIssuers`, `Import`, `List`, `ListIssuers`, `ManageContacts`, `ManageIssuers`, `Purge`, `Recover`, `Restore`, `SetIssuers`, and `Update`.<br/>- `key_permissions` - (Optional) A list of key permissions. Possible value are: `Backup`, `Create`, `Decrypt`, `Delete`, `Encrypt`, `Get`, `Import`, `List`, `Purge`, `Recover`, `Restore`, `Sign`, `UnwrapKey`, `Update`, `Verify`, `WrapKey`, `Release`, `Rotate`, `GetRotationPolicy`, and `SetRotationPolicy`.<br/>- `secret_permissions` - (Optional) A list of secret permissions. Possible values are: `Backup`, `Delete`, `Get`, `List`, `Purge`, `Recover`, `Restore`, and `Set`.<br/>- `storage_permissions` - (Optional) A list of storage permissions. Possible values are: `Backup`, `Delete`, `DeleteSAS`, `Get`, `GetSAS`, `List`, `ListSas`, `Purge`, `Recover`, `RegenerateKey`, `Restore`, `Set`, `SetSAS`, and `Update`. | <pre>map(object({<br/>    object_id               = string<br/>    application_id          = optional(string, null)<br/>    certificate_permissions = optional(set(string), [])<br/>    key_permissions         = optional(set(string), [])<br/>    secret_permissions      = optional(set(string), [])<br/>    storage_permissions     = optional(set(string), [])<br/>  }))</pre> | `{}` | no |
| <a name="input_legacy_access_policies_enabled"></a> [legacy\_access\_policies\_enabled](#input\_legacy\_access\_policies\_enabled) | Specifies whether legacy access policies are enabled for this Key Vault. Prevents use of Azure RBAC for data plane. | `bool` | `false` | no |
| <a name="input_location"></a> [location](#input\_location) | The Azure location where the resources will be deployed. | `string` | n/a | yes |
| <a name="input_lock"></a> [lock](#input\_lock) | The lock level to apply to the Key Vault. Default is `None`. Possible values are `None`, `CanNotDelete`, and `ReadOnly`. | <pre>object({<br/>    kind = string<br/>    name = optional(string, null)<br/>  })</pre> | `null` | no |
| <a name="input_network_acls"></a> [network\_acls](#input\_network\_acls) | The network ACL configuration for the Key Vault.<br/>If not specified then the Key Vault will be created with a firewall that blocks access.<br/>Specify `null` to create the Key Vault with no firewall.<br/><br/>- `bypass` - (Optional) Should Azure Services bypass the ACL. Possible values are `AzureServices` and `None`. Defaults to `AzureServices`.<br/>- `default_action` - (Optional) The default action when no rule matches. Possible values are `Allow` and `Deny`. Defaults to `Deny`.<br/>- `ip_rules` - (Optional) A list of IP rules in CIDR format. Defaults to `[]`.<br/>- `virtual_network_subnet_ids` - (Optional) When using with Service Endpoints, a list of subnet IDs to associate with the Key Vault. Defaults to `[]`. | <pre>object({<br/>    bypass                     = optional(string, "AzureServices") <br/>    default_action             = optional(string, "Deny")<br/>    ip_rules                   = optional(list(string), [])<br/>    virtual_network_subnet_ids = optional(list(string), [])<br/>  })</pre> | `{}` | no |
| <a name="input_object_id"></a> [object\_id](#input\_object\_id) | The object ID of the user, group, or application that requires access to the Key Vault. | `string` | n/a | yes |
| <a name="input_objective_code"></a> [objective\_code](#input\_objective\_code) | 4 letter abbreviation of the objective of the resource | `string` | n/a | yes |
| <a name="input_private_endpoints"></a> [private\_endpoints](#input\_private\_endpoints) | A map of private endpoints to create on the Key Vault. The map key is deliberately arbitrary to avoid issues where map keys maybe unknown at plan time.<br/><br/>- `name` - (Optional) The name of the private endpoint. One will be generated if not set.<br/>- `role_assignments` - (Optional) A map of role assignments to create on the private endpoint. The map key is deliberately arbitrary to avoid issues where map keys maybe unknown at plan time. See `var.role_assignments` for more information.<br/>- `lock` - (Optional) The lock level to apply to the private endpoint. Default is `None`. Possible values are `None`, `CanNotDelete`, and `ReadOnly`.<br/>- `tags` - (Optional) A mapping of tags to assign to the private endpoint.<br/>- `subnet_resource_id` - The resource ID of the subnet to deploy the private endpoint in.<br/>- `private_dns_zone_group_name` - (Optional) The name of the private DNS zone group. One will be generated if not set.<br/>- `private_dns_zone_resource_ids` - (Optional) A set of resource IDs of private DNS zones to associate with the private endpoint. If not set, no zone groups will be created and the private endpoint will not be associated with any private DNS zones. DNS records must be managed external to this module.<br/>- `application_security_group_resource_ids` - (Optional) A map of resource IDs of application security groups to associate with the private endpoint. The map key is deliberately arbitrary to avoid issues where map keys maybe unknown at plan time.<br/>- `private_service_connection_name` - (Optional) The name of the private service connection. One will be generated if not set.<br/>- `network_interface_name` - (Optional) The name of the network interface. One will be generated if not set.<br/>- `location` - (Optional) The Azure location where the resources will be deployed. Defaults to the location of the resource group.<br/>- `resource_group_name` - (Optional) The resource group where the resources will be deployed. Defaults to the resource group of the Key Vault.<br/>- `ip_configurations` - (Optional) A map of IP configurations to create on the private endpoint. If not specified the platform will create one. The map key is deliberately arbitrary to avoid issues where map keys maybe unknown at plan time.<br/>  - `name` - The name of the IP configuration.<br/>  - `private_ip_address` - The private IP address of the IP configuration. | <pre>map(object({<br/>    name = optional(string, null)<br/>    role_assignments = optional(map(object({<br/>      role_definition_id_or_name             = string<br/>      principal_id                           = string<br/>      description                            = optional(string, null)<br/>      skip_service_principal_aad_check       = optional(bool, false)<br/>      condition                              = optional(string, null)<br/>      condition_version                      = optional(string, null)<br/>      delegated_managed_identity_resource_id = optional(string, null)<br/>      principal_type                         = optional(string, null)<br/>    })), {})<br/>    lock = optional(object({<br/>      kind = string<br/>      name = optional(string, null)<br/>    }), null)<br/>    tags                                    = optional(map(string), null)<br/>    subnet_resource_id                      = string<br/>    private_dns_zone_group_name             = optional(string, "default")<br/>    private_dns_zone_resource_ids           = optional(set(string), [])<br/>    application_security_group_associations = optional(map(string), {})<br/>    private_service_connection_name         = optional(string, null)<br/>    network_interface_name                  = optional(string, null)<br/>    location                                = optional(string, null)<br/>    resource_group_name                     = optional(string, null)<br/>    ip_configurations = optional(map(object({<br/>      name               = string<br/>      private_ip_address = string<br/>    })), {})<br/>  }))</pre> | `{}` | no |
| <a name="input_private_endpoints_manage_dns_zone_group"></a> [private\_endpoints\_manage\_dns\_zone\_group](#input\_private\_endpoints\_manage\_dns\_zone\_group) | Whether to manage private DNS zone groups with this module. If set to false, you must manage private DNS zone groups externally, e.g. using Azure Policy. | `bool` | `true` | no |
| <a name="input_public_network_access_enabled"></a> [public\_network\_access\_enabled](#input\_public\_network\_access\_enabled) | Specifies whether public access is permitted. | `bool` | `false` | no |
| <a name="input_purge_protection_enabled"></a> [purge\_protection\_enabled](#input\_purge\_protection\_enabled) | Specifies whether protection against purge is enabled for this Key Vault. Note once enabled this cannot be disabled. | `bool` | `true` | no |
| <a name="input_region_code"></a> [region\_code](#input\_region\_code) | 3 letter Region code (e.g., EU2 for East US 2) | `string` | n/a | yes |
| <a name="input_resource_group_name"></a> [resource\_group\_name](#input\_resource\_group\_name) | The resource group where the resources will be deployed. | `string` | n/a | yes |
| <a name="input_role_assignments"></a> [role\_assignments](#input\_role\_assignments) | A map of role assignments to create on the Key Vault. The map key is deliberately arbitrary to avoid issues where map keys maybe unknown at plan time.<br/><br/>- `role_definition_id_or_name` - The ID or name of the role definition to assign to the principal.<br/>- `principal_id` - The ID of the principal to assign the role to.<br/>- `description` - The description of the role assignment.<br/>- `skip_service_principal_aad_check` - If set to true, skips the Azure Active Directory check for the service principal in the tenant. Defaults to false.<br/>- `condition` - The condition which will be used to scope the role assignment.<br/>- `condition_version` - The version of the condition syntax. If you are using a condition, valid values are '2.0'.<br/><br/>> Note: only set `skip_service_principal_aad_check` to true if you are assigning a role to a service principal. | <pre>map(object({<br/>    role_definition_id_or_name             = string<br/>    principal_id                           = string<br/>    description                            = optional(string, null)<br/>    skip_service_principal_aad_check       = optional(bool, false)<br/>    condition                              = optional(string, null)<br/>    condition_version                      = optional(string, null)<br/>    delegated_managed_identity_resource_id = optional(string, null)<br/>    principal_type                         = optional(string, null)<br/>  }))</pre> | `{}` | no |
| <a name="input_secret_permissions"></a> [secret\_permissions](#input\_secret\_permissions) | List of permissions for secrets in the Key Vault. | `list(string)` | <pre>[<br/>  "Get",<br/>  "List",<br/>  "Set",<br/>  "Delete"<br/>]</pre> | no |
| <a name="input_secrets"></a> [secrets](#input\_secrets) | A map of secrets to create on the Key Vault. The map key is deliberately arbitrary to avoid issues where map keys maybe unknown at plan time.<br/><br/>- `name` - The name of the secret.<br/>- `content_type` - The content type of the secret.<br/>- `tags` - A mapping of tags to assign to the secret.<br/>- `not_before_date` - The not before date of the secret.<br/>- `expiration_date` - The expiration date of the secret.<br/><br/>Supply role assignments in the same way as for `var.role_assignments`.<br/><br/>> Note: the `value` of the secret is supplied via the `var.secrets_value` variable. Make sure to use the same map key. | <pre>map(object({<br/>    name            = string<br/>    content_type    = optional(string, null)<br/>    tags            = optional(map(any), null)<br/>    not_before_date = optional(string, null)<br/>    expiration_date = optional(string, null)<br/><br/>    role_assignments = optional(map(object({<br/>      role_definition_id_or_name             = string<br/>      principal_id                           = string<br/>      description                            = optional(string, null)<br/>      skip_service_principal_aad_check       = optional(bool, false)<br/>      condition                              = optional(string, null)<br/>      condition_version                      = optional(string, null)<br/>      delegated_managed_identity_resource_id = optional(string, null)<br/>      principal_type                         = optional(string, null)<br/>    })), {})<br/>  }))</pre> | `{}` | no |
| <a name="input_secrets_value"></a> [secrets\_value](#input\_secrets\_value) | A map of secret keys to values.<br/>The map key is the supplied input to `var.secrets`.<br/>The map value is the secret value.<br/><br/>This is a separate variable to `var.secrets` because it is sensitive and therefore cannot be used in a `for_each` loop. | `map(string)` | `null` | no |
| <a name="input_sku_name"></a> [sku\_name](#input\_sku\_name) | The SKU name of the Key Vault. Default is `premium`. Possible values are `standard` and `premium`. | `string` | `"premium"` | no |
| <a name="input_soft_delete_retention_days"></a> [soft\_delete\_retention\_days](#input\_soft\_delete\_retention\_days) | The number of days that items should be retained for once soft-deleted. This value can be between 7 and 90 (the default) days. | `number` | `null` | no |
| <a name="input_tags"></a> [tags](#input\_tags) | Map of tags to assign to the Key Vault resource. | `map(string)` | `null` | no |
| <a name="input_tenant_id"></a> [tenant\_id](#input\_tenant\_id) | The Azure tenant ID used for authenticating requests to Key Vault. You can use the `azurerm_client_config` data source to retrieve it. | `string` | n/a | yes |
| <a name="input_wait_for_rbac_before_contact_operations"></a> [wait\_for\_rbac\_before\_contact\_operations](#input\_wait\_for\_rbac\_before\_contact\_operations) | This variable controls the amount of time to wait before performing contact operations.<br/>It only applies when `var.role_assignments` and `var.contacts` are both set.<br/>This is useful when you are creating role assignments on the key vault and immediately creating keys in it.<br/>The default is 30 seconds for create and 0 seconds for destroy. | <pre>object({<br/>    create  = optional(string, "30s")<br/>    destroy = optional(string, "0s")<br/>  })</pre> | `{}` | no |
| <a name="input_wait_for_rbac_before_key_operations"></a> [wait\_for\_rbac\_before\_key\_operations](#input\_wait\_for\_rbac\_before\_key\_operations) | This variable controls the amount of time to wait before performing key operations.<br/>It only applies when `var.role_assignments` and `var.keys` are both set.<br/>This is useful when you are creating role assignments on the key vault and immediately creating keys in it.<br/>The default is 30 seconds for create and 0 seconds for destroy. | <pre>object({<br/>    create  = optional(string, "30s")<br/>    destroy = optional(string, "0s")<br/>  })</pre> | `{}` | no |
| <a name="input_wait_for_rbac_before_secret_operations"></a> [wait\_for\_rbac\_before\_secret\_operations](#input\_wait\_for\_rbac\_before\_secret\_operations) | This variable controls the amount of time to wait before performing secret operations.<br/>It only applies when `var.role_assignments` and `var.secrets` are both set.<br/>This is useful when you are creating role assignments on the key vault and immediately creating secrets in it.<br/>The default is 30 seconds for create and 0 seconds for destroy. | <pre>object({<br/>    create  = optional(string, "30s")<br/>    destroy = optional(string, "0s")<br/>  })</pre> | `{}` | no |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_id"></a> [id](#output\_id) | The ID of the AKV |
| <a name="output_name"></a> [name](#output\_name) | The name of the AKV |
<!-- END_TF_DOCS -->